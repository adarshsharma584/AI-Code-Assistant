                ┌────────────────────────────┐
                │        Client (UI)         │
                │ (Learn / Review / Explain  │
                │  / Roadmap Pages + Sidebar)│
                └───────────┬────────────────┘
                            │
  ─────────── User sends a message ───────────
                            │
                            ▼
                ┌────────────────────────────┐
                │        API Gateway          │
                │   (Express.js / Fastify)   │
                └───────────┬────────────────┘
                            │
                            ▼
                ┌────────────────────────────┐
                │      Auth Middleware        │
                │  (Check JWT → userId)       │
                └───────────┬────────────────┘
                            │
          ┌─────────────────┼───────────────────┐
          ▼                 ▼                   ▼
 ┌────────────────┐  ┌────────────────────────┐   ┌───────────────────────────┐
 │ Auth Service   │  │       Chat Service     │   │        AI Service         │
 │  (validate     │  │ (Save user/AI msgs in │   │ (Send msg → Gemini API    │
 │   identity)    │  │   DB under sessionId) │   │  → Receive AI response)   │
 └────────────────┘  └────────────────────────┘   └───────────────────────────┘
                            │                                 │
                            │                                 ▼
                            │                      ┌───────────────────────────┐
                            │                      │  External AI API          │
                            │                      │  (Google Gemini / GPT)    │
                            │                      └───────────────────────────┘
                            │
                            ▼
                ┌────────────────────────────┐
                │     Chat Database (Mongo)  │
                │   Collection: Chats        │
                │   {                        │
                │     _id: ObjectId,         │
                │     sessionId: string,     │
                │     userId: string,        │
                │     messages: [            │
                │       {role: "user",       │
                │        content: "...",     │
                │        timestamp: ...},    │
                │       {role: "ai",         │
                │        content: "...",     │
                │        timestamp: ...}     │
                │     ],                     │
                │     page: "learn"          │
                │   }                        │
                └────────────────────────────┘
                            │
  ─────────── Fetching old chats ────────────
                            │
                            ▼
                ┌────────────────────────────┐
                │  API Endpoint: /chats/:page │
                │  (Fetch all sessions for    │
                │   userId + page)            │
                └───────────┬────────────────┘
                            │
                            ▼
                ┌────────────────────────────┐
                │   Return to Frontend        │
                │  → Sidebar loads sessions   │
                │  → On click: fetch by       │
                │    sessionId                │
                └───────────┬────────────────┘
                            │
                            ▼
                ┌────────────────────────────┐
                │   Client (UI)               │
                │  - Display old msgs in order│
                │  - New msg appended at end  │
                │  - Scroll like chat         │
                └────────────────────────────┘
